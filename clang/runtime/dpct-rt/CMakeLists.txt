set(dpct_rt_files
  include/dpct.hpp
  include/atomic.hpp
  include/device.hpp
  include/math.hpp
  include/memory.hpp
  include/kernel.hpp
  include/image.hpp
  include/util.hpp
  include/blas_utils.hpp
  include/dnnl_utils.hpp
  include/dpl_utils.hpp
  include/rng_utils.hpp
  include/lib_common_utils.hpp
  include/ccl_utils.hpp
  include/sparse_utils.hpp
  include/fft_utils.hpp
  include/lapack_utils.hpp
)

set(dpct_rt_dpstd_files
  include/dpl_extras/functional.h
  include/dpl_extras/memory.h
  include/dpl_extras/iterators.h
  include/dpl_extras/algorithm.h
  include/dpl_extras/numeric.h
  include/dpl_extras/vector.h
  include/dpl_extras/dpcpp_extensions.h
)

set(output_dir ${LLVM_LIBRARY_OUTPUT_INTDIR}/clang/${CLANG_VERSION}/include/dpct)
set(output_dpstd_dir ${LLVM_LIBRARY_OUTPUT_INTDIR}/clang/${CLANG_VERSION}/include/dpct/dpl_extras)

set(out_files)
foreach( f ${dpct_rt_files})
  set( src ${CMAKE_CURRENT_SOURCE_DIR}/${f} )
  set( dst ${output_dir}/${f} )
  add_custom_command(OUTPUT ${dst}
    DEPENDS ${src}
    COMMAND ${CMAKE_COMMAND} -E copy_if_different ${src} ${dst}
    COMMENT "Copying clang's ${f}...")
  list(APPEND out_files ${dst})
endforeach( f )

foreach( f ${dpct_rt_dpstd_files})
  set( src ${CMAKE_CURRENT_SOURCE_DIR}/${f} )
  set( dst ${output_dpstd_dir}/${f} )
  add_custom_command(OUTPUT ${dst}
    DEPENDS ${src}
    COMMAND ${CMAKE_COMMAND} -E copy_if_different ${src} ${dst}
    COMMENT "Copying clang's ${f}...")
  list(APPEND out_files ${dst})
endforeach( f )
add_custom_target(dpct-headers ALL DEPENDS ${out_files})
#add_custom_target(dpct-headers ALL DEPENDS dpct_helper_headers_and_inc)

install(
  FILES ${dpct_rt_files}
  COMPONENT dpct-headers
  PERMISSIONS OWNER_READ OWNER_WRITE GROUP_READ WORLD_READ
  DESTINATION include/dpct)

install(
  FILES ${dpct_rt_dpstd_files}
  COMPONENT dpct-headers
  PERMISSIONS OWNER_READ OWNER_WRITE GROUP_READ WORLD_READ
  DESTINATION include/dpct/dpl_extras)

if (NOT CMAKE_CONFIGURATION_TYPES) # don't add this for IDE's.
  add_llvm_install_targets(install-dpct-headers
                           DEPENDS dpct-headers
                           COMPONENT dpct-headers)
endif()
